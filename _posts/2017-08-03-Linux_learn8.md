---
layout: post
title: Linux学习小记8
category: Linux
descriptions: Linux学习
keywords: Linux
---

今天是学习《实战LINUX_SHELL编程与服务器管理》的最后一天，计划学完剩下部分。

<!-- more --> 

### 进程管理和工作控制

1. `ps` 显示目前内存中的进程，Linux版的ps是读取/proc这个虚拟目录中的文件，以获取目前核心及进程信息。

   + System V风格：`ps -ax` 或 `ps -a -x`
   + BSD风格：`ps ax` 或 `ps a x`
   + `ps --pid $$` $$表示要显示的是目前的Bash Shell的进程信息。

   ps命令的选项和用法很多样，可以显示进程、列出进程的树状结构、自定义输出字段（进程编号pid、执行优先级ni、使用者user、程序和参数args）等。

   进程状态STAT表示不同的执行状态，如D：不可中断的休眠（通常是I/O），R：可执行的

   ，S：休眠，X：死亡，<：高优先级，N：低优先级，T：被追踪或被停止，+：在前台的进程群组中等。

2. `top` 除了列出进程信息外，还显示主机的重要系统信息（如工作负载、进程统计、CPU使用率、内存和交换空间的耗用等）

   按u接着输入使用者名称，可以找出某一使用者的进程。

   按q可结束top的执行。

3. `htop` 相比top操作更直观简便

4. `nice -n nice值 程序` nice命令运用于尚未执行的程序，指定程序执行时的某一nice值， nice值越低，优先级越高。不指定nice值，预设使用10。

   nice值通常介于-20～20，在-20～0的nice值只有root权限者才能调整。（PRI也是进程优先级的一种表示法，PRI=NI+20，最大值为39）

5. `renice nice值 -p PID -g 群组 -u 使用者名称` 调整某一个已执行进程的优先级。

6. `&` 将指令丢到背景执行。

7. `bg` 将暂停的工作丢到背景执行。例如，`bg &?sl` 把程序名称含有sl的字符串的工作丢到背景，`bg &./sl` 把程序名称开头是./sl的工作丢到背景。

8. `fg` 将暂停的工作拉回到前台执行。

9. `jobs` 列出工作。

10. `disown` 移除工作

11. `kill` 传送信号给进程或工作。

12. `wait` 等待子进程结束，传回最后一个命令的执行状态。

13. `suspend` 暂停目前的Shell。

14. 进程替换

    + 命令< (指令行)
    + \> (指令行)

---

### 历史命令

1. 历史脚本文件的路径文件名由Bash的内置变量HISTFILE定义。

2. 可利用HISTGNORE控制某些指令不予存入，来精简历史脚本文件。

   `export HISTGNORE=ls:ps:cd:t*:\&`如果一直键入重复的命令，则只存入一个。

3. 内置变量HISTCONTROL也可以控制指令是否存入脚本文件。

   `export HISTCONTROL=ignoreboth`连续重复的指令只存一个，指令开头有空格的不存入。

4. `fc` 命令也有搜寻的功能，如`fc -s ls`会搜寻最近一个以ls开头的命令，并执行。

5. `history` 命令也不陌生了，执行它查看历史命令后，进行以下指令，非常方便。

   + `!n`来调用编号n的历史指令。
   + `!!` 执行前一个指令。
   + `!字符串` 最近一个以“字符串”开头的历史指令。
   + `!?字符串?` 最近一个含有“字符串”的历史指令。
   + （还有很多种，只列几个看起来会用得到的）

---

### 文件操作

1. `mknod 选项 文件名 文件形态 主要设备代码 次要设备代码`

   可用来建立特殊的文件，如区块设备文件、字符设备文件、FIFO文件。

   + 建立区块设备文件

     `mknod -m 666 nyhda1 b 3 1` 建立一个区块设备文件名为myhda1，指定文件权限为0666，文件形态是区块设备文件（b），主要设备代码MAJOR为3，次要设备代码MINOR为1。

   + 建立字符设备文件

     `mknod -m 666 nullfile c 1 3` 建立一个和/dev/null相同属性的字符设备文件。

   + 建立FIFO文件

     `mknod myfifo p` 在建立FIFO文件时，，可以不指定MAJOR和MINOR。

2. `nksock mysocket`建立Socket文件.

3. `ln -s test.txt tfile` 建立新的符号链接文件tfile，指向test.txt。

4. `stat` 获取文件属性。

5. `chattr`改变文件属性。

6. 每一个文件都有三种时间：

   + Access time：取用文件的时间。
   + Modify time：修改文件内容的时间。
   + Change time：文件属性或文件位置改动的时间。

---

### 主机安全管理

1. 列出核心信息

   + `uname -s` 核心名称
   + `uname -n` 主机名
   + `uname -r` 核心版本
   + `uname -v` 核心编译版次
   + `uname -m` 核心所在主机硬件
   + `uname -o` 操作系统种类
   + `uname -a` 核心所有信息，即以上6种

2. `free` 主机内存使用情况，-s选项指定每几秒更新一次。

3. 取得主机中磁盘驱动器种类：

   读取/proc/partitions虚拟文件中的分区信息，找到设备名称后，再读取该设备目录下关于磁盘的信息文件。

4. `fdisk -l /dev/磁盘设备名称` 列出磁盘内容

5. `df` 列出磁盘用量。



## 学习中遇到的问题

安装linux server版，tty出现很多小方块。

（暂未解决）

## 这几天学习的心得

用了四天时间，基本看完这本书，大致了解了linux在各方面的功能和任务、常见命令和shell脚本，感觉进度有点快，甚至有点消化不了，但是我也很赞同“先有再优”的观点。